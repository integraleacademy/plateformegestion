<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{{ title }}</title>
  <style>
    body {font-family: Arial, sans-serif; background:#fdfaf5; padding:20px;}
    h1 {text-align:center; color:#1e8449;}
    table {width:100%; border-collapse:collapse; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.1); border-radius:10px; overflow:hidden;}
    th, td {padding:10px; border-bottom:1px solid #ddd; text-align:center;}
    th {background:#f4f6f7; font-weight:700;}
    .btn {padding:5px 10px; border:none; border-radius:5px; cursor:pointer; font-size:13px;}
    .btn-edit {background:#3498db; color:#fff;}
    .btn-del {background:#e74c3c; color:#fff;}
    .btn-mail {background:#f39c12; color:#fff;}
    .btn-green {background:#27ae60; color:#fff;}
    .status-gray {background:#ccc; color:#fff; padding:5px 10px; border-radius:20px;}
    .status-green {background:#2ecc71; color:#fff; padding:5px 10px; border-radius:20px;}
    .status-red {background:#e74c3c; color:#fff; padding:5px 10px; border-radius:20px;}
    form.inline {display:inline;}
    .form-add {margin:20px auto; background:#fff; padding:15px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.1); max-width:900px;}
    input, textarea {padding:6px; margin:4px; border:1px solid #ccc; border-radius:6px;}
    textarea {width:100%; height:40px;}
    .center {text-align:center; margin-top:20px;}
  </style>
</head>
<body>
  <h1>üì¶ Gestion des dotations</h1>

  <form class="form-add" method="POST" action="{{ url_for('add_dotation') }}">
    <h3>Ajouter une dotation</h3>
    <input name="nom" placeholder="Nom" required>
    <input name="prenom" placeholder="Pr√©nom" required>
    <input type="email" name="email" placeholder="Email" required>
    <input name="ipad" placeholder="N¬∞ s√©rie iPad">
    <input name="badge" placeholder="N¬∞ badge caf√©">
    <input type="date" name="date_remise" placeholder="Date remise">
    <input name="commentaire" placeholder="Commentaire">
    <button type="submit" class="btn btn-green">Ajouter</button>
  </form>

  <table>
    <tr>
      <th>Nom</th>
      <th>Pr√©nom</th>
      <th>Email</th>
      <th>iPad</th>
      <th>Badge</th>
      <th>Date remise</th>
      <th>Statut</th>
      <th>Commentaire</th>
      <th>Actions</th>
    </tr>
    {% for d in dotations %}
    <tr>
      <td>{{ d.nom }}</td>
      <td>{{ d.prenom }}</td>
      <td>{{ d.email }}</td>
      <td>{{ d.ipad }}</td>
      <td>{{ d.badge }}</td>
      <td>{{ d.date_remise }}</td>
      <td>
        {% if d.statut == "Dotation √† distribuer" %}
          <span class="status-gray">{{ d.statut }}</span>
        {% elif d.statut == "Dotation distribu√©e" or d.statut == "Dotation restitu√©e" %}
          <span class="status-green">{{ d.statut }}</span>
        {% elif d.statut == "Dotation non restitu√©e" %}
          <span class="status-red">{{ d.statut }}</span>
        {% else %}
          {{ d.statut }}
        {% endif %}
      </td>
      <td>{{ d.commentaire }}</td>
      <td>
        <form class="inline" method="POST" action="{{ url_for('rupture_contrat', id=d.id) }}">
          <button class="btn btn-mail" title="Rupture de contrat"‚ö†Ô∏è Rupture</button>
        </form>
        <form class="inline" method="POST" action="{{ url_for('badge_fin', id=d.id) }}">
          <button class="btn btn-mail" title="Fin d'√©tude">üéì Badge</button>
        </form>
        <form class="inline" method="POST" action="{{ url_for('delete_dotation', id=d.id) }}">
          <button class="btn btn-del">üóëÔ∏è</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>

  <div class="center">
    <a href="{{ url_for('index') }}" class="btn btn-edit">‚¨ÖÔ∏è Retour √† l'accueil</a>
  </div>
</body>
</html>
